source leaprc.protein.ff19SB
source leaprc.water.tip3p
addAtomTypes { { "ZN" "Zn" "sp3" } { "S3" "S" "sp3" } } #Add atom types for the ZAFF metal center with Center ID 1
loadamberparams frcmod.ions1lm_126_tip3p
loadamberprep ZAFF.prep #Load ZAFF prep file
loadamberparams ZAFF.frcmod #Load ZAFF frcmod file

mol = loadpdb 1.15_modified.pdb # Load the PDB file

bond mol.313.ZN mol.210.SG #Bond zinc ion with SG atom of residue CYM
bond mol.313.ZN mol.213.SG #Bond zinc ion with SG atom of residue CYM
bond mol.313.ZN mol.278.SG #Bond zinc ion with SG atom of residue CYM
bond mol.313.ZN mol.281.SG #Bond zinc ion with SG atom of residue CYM
solvateOct mol TIP3PBOX 15.0

addions mol CL 0

savepdb mol system_solvated.pdb #Save the pdb file
saveamberparm mol system.prmtop system.inpcrd #Save the topology and coordinate files
quit #Quit tleap
